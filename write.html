<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®ç”Ÿæˆ - çŒ«çŒ«å’©å’©é˜…è§ˆå®¤</title>
    <style>
        :root {
            --brand-color: #2d6a4f;
            --brand-light: rgba(240, 249, 244, 0.9);
            --brand-hover: rgba(220, 237, 226, 0.95);
            --material-bg: #fffcf0;
            --text-main: #1a202c;
            --text-muted: #4a5568;
            --nav-bg: rgba(255, 255, 255, 0.85);
        }

        body { 
            margin: 0; font-family: "Georgia", "PingFang SC", serif; 
            background-image: url('sea.avif');
            background-size: cover; background-position: center; background-attachment: fixed;
            padding-top: 60px; color: var(--text-main);
        }

        /* --- å¯¼èˆªæ  --- */
        .top-nav {
            position: fixed; top: 0; width: 100%; height: 60px;
            background: var(--nav-bg); backdrop-filter: blur(12px);
            z-index: 1000; display: flex; align-items: center; padding: 0 50px;
            box-sizing: border-box; box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        }
        .nav-item { cursor: pointer; font-weight: bold; color: var(--brand-color); text-decoration: none; font-size: 1.1rem; transition: 0.3s; }
        .nav-item:hover { opacity: 0.7; }

        .music-controls { display: flex; align-items: center; gap: 8px; margin-left: auto; }
        .music-btn { width: 32px; height: 32px; background: none; border: none; cursor: pointer; color: var(--brand-color); display: flex; align-items: center; justify-content: center; transition: 0.2s; border-radius: 50%; padding: 0; opacity: 0.7; }
        .music-btn:hover { transform: scale(1.1); opacity: 1; }
        .music-btn.skip { font-size: 0.8rem; opacity: 0; pointer-events: none; }
        .top-nav:hover .music-btn.skip { opacity: 0.7; pointer-events: auto; }

        /* --- é¡¶éƒ¨ Banner --- */
        .hero-banner {
            height: 350px; width: 100%; position: relative;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
            -webkit-mask-image: linear-gradient(to bottom, black 0%, black 70%, transparent 100%);
        }
        .hero-slideshow {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center;
            transition: opacity 1.5s ease-in-out, transform 4.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
            opacity: 0; z-index: 1; transform: scale(1);
        }
        .hero-slideshow.active { opacity: 1; z-index: 2; }

        /* æ ‡é¢˜æ¡†é¼ æ ‡ç§»å…¥å˜é€æ˜ */
        .hero-title-box {
            position: relative; z-index: 10; background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            padding: 30px 50px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.2); 
            text-align: center; box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            transition: background 0.5s, border-color 0.5s, backdrop-filter 0.5s, box-shadow 0.5s;
        }
        .hero-title-box:hover { 
            background: rgba(0, 0, 0, 0); 
            border-color: rgba(0, 0, 0, 0); 
            backdrop-filter: none; 
            -webkit-backdrop-filter: none;
            box-shadow: none;
        }
        .hero-title { font-size: 2.2rem; margin: 0; color: white; letter-spacing: 3px; text-shadow: 0 2px 15px rgba(0,0,0,0.4); }

        /* --- åŠ¨æ€æ³¢æµª --- */
        .waves-container { position: absolute; bottom: 0; left: 0; width: 100%; height: 100px; z-index: 5; }
        .waves { width: 100%; height: 100%; }
        .parallax > use { animation: move-forever 25s cubic-bezier(.55,.5,.45,.5) infinite; }
        @keyframes move-forever { 0% { transform: translate3d(-90px,0,0); } 100% { transform: translate3d(85px,0,0); } }

        /* --- ä¸»ç¼–è¾‘åŒº --- */
        .main-container { max-width: 900px; margin: -40px auto 80px; position: relative; z-index: 20; padding: 0 20px; }
        .write-card {
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            border-radius: 20px; padding: 40px; box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        /* è¡¨å•æ ·å¼ */
        .meta-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; border-bottom: 2px dashed var(--brand-light); padding-bottom: 30px; }
        .input-group { display: flex; flex-direction: column; gap: 6px; }
        label { font-weight: bold; color: var(--brand-color); font-size: 0.85rem; }
        input, select, textarea { 
            padding: 12px; border: 1px solid rgba(0,0,0,0.08); border-radius: 8px; 
            background: white; font-family: inherit; font-size: 1rem;
        }
        input:focus { outline: 2px solid var(--brand-color); border-color: transparent; }

        /* Jupyter é£æ ¼å•å…ƒæ ¼ */
        .content-cell {
            position: relative; margin-bottom: 20px; padding: 25px;
            border-radius: 12px; border-left: 6px solid #ccc;
            background: #fff; transition: 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }
        .cell-material { border-left-color: #e9d8a6; background: var(--material-bg); }
        .cell-comment { border-left-color: var(--brand-color); background: var(--brand-light); }
        
        .cell-type-tag {
            position: absolute; top: -10px; right: 15px; font-size: 0.7rem; 
            padding: 3px 12px; border-radius: 20px; color: white; font-weight: bold;
        }
        .cell-material .cell-type-tag { background: #b89b3d; }
        .cell-comment .cell-type-tag { background: var(--brand-color); }

        .cell-textarea { width: 100%; min-height: 100px; border: none; background: transparent; outline: none; resize: vertical; line-height: 1.7; font-size: 1rem; }

        /* æŒ‰é’® */
        .actions { display: flex; gap: 15px; justify-content: center; margin: 30px 0; }
        .btn { padding: 12px 25px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; transition: 0.3s; font-family: inherit; }
        .btn-add-m { background: #e9d8a6; color: #5f4d1a; }
        .btn-add-c { background: var(--brand-color); color: white; }
        .btn-gen { background: #1a202c; color: white; width: 100%; font-size: 1.1rem; margin-top: 20px; }
        .btn-del { background: transparent; color: #e63946; font-size: 0.8rem; border: 1px solid #e63946; margin-top: 10px; padding: 4px 10px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); opacity: 0.9; }

        /* è¾“å‡ºåŒº */
        #output-area {
            margin-top: 40px; background: #1e1e1e; color: #d4d4d4;
            padding: 25px; border-radius: 12px; font-family: "Consolas", monospace;
            white-space: pre-wrap; word-break: break-all;
            display: none; border-left: 6px solid #007acc; font-size: 0.9rem;
        }
    </style>
</head>

<body>

<nav class="top-nav">
    <a href="index.html" class="nav-item">ğŸŒŠ è¿”å›é¦–é¡µ</a>
    <div class="music-controls">
        <button class="music-btn skip" id="prev-btn">â®</button>
        <button class="music-btn" id="music-toggle">â–¶</button>
        <button class="music-btn skip" id="next-btn">â­</button>
    </div>
</nav>

<header class="hero-banner">
    <div id="slide1" class="hero-slideshow active"></div>
    <div id="slide2" class="hero-slideshow"></div>
    
    <div class="hero-title-box">
        <h1 class="hero-title">ğŸ“ ç¬”è®°æ•°æ®ç”Ÿæˆ</h1>
    </div>

    <div class="waves-container">
        <svg class="waves" xmlns="http://www.w3.org/2000/svg" viewBox="0 24 150 28" preserveAspectRatio="none">
            <defs><path id="wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" /></defs>
            <g class="parallax">
                <use xlink:href="#wave" x="48" y="0" fill="rgba(255,255,255,0.3)" />
                <use xlink:href="#wave" x="48" y="3" fill="rgba(255,255,255,0.2)" />
                <use xlink:href="#wave" x="48" y="5" fill="rgba(255,255,255,0.1)" />
                <use xlink:href="#wave" x="48" y="7" fill="rgba(255,255,255,0.6)" />
            </g>
        </svg>
    </div>
</header>

<main class="main-container">
    <div class="write-card">
        <div class="meta-grid">
            <div class="input-group"><label>æ ‡é¢˜</label><input type="text" id="title" placeholder="ç¬”è®°æ ‡é¢˜"></div>
            <div class="input-group"><label>ä½œè€…/æ‘˜æŠ„</label><input type="text" id="author" placeholder="ä½œè€…/æ‘˜æŠ„è€…"></div>
            <div class="input-group"><label>æ—¶é—´</label><input type="date" id="time"></div>
            <div class="input-group"><label>æ¥æº</label><input type="text" id="source" placeholder="ä¹¦åæˆ–æ–‡ç« å"></div>
            <div class="input-group">
                <label>ç±»å‹</label>
                <select id="type">
                    <option value="ä¹¦">ä¹¦</option><option value="è®ºæ–‡">è®ºæ–‡</option><option value="å…¶å®ƒ">å…¶å®ƒ</option>
                </select>
            </div>
            <div class="input-group"><label>æ ‡ç­¾ (é€—å·åˆ†éš”)</label><input type="text" id="tag" placeholder="ä¾‹ï¼šå“²å­¦, æ€ç»´"></div>
            <div class="input-group" style="grid-column: span 2;"><label>PDF é™„ä»¶ (æ–‡ä»¶å, é€—å·åˆ†éš”)</label><input type="text" id="link" placeholder="1.pdf, 2.pdf"></div>
            <div class="input-group" style="grid-column: span 2;"><label>è¯¦ç»†è¯´æ˜ (Detail)</label><input type="text" id="detail" placeholder="å‡ºç‰ˆä¿¡æ¯æˆ–å¤‡æ³¨"></div>
        </div>

        <div id="cells-container">
            <div class="content-cell cell-material" data-type="material">
                <span class="cell-type-tag">æ‘˜æŠ„å—</span>
                <textarea class="cell-textarea" placeholder="è¾“å…¥æ‘˜æŠ„å†…å®¹..."></textarea>
            </div>
        </div>

        <div class="actions">
            <button class="btn btn-add-m" onclick="addCell('material')">+ å¢åŠ æ‘˜æŠ„å—</button>
            <button class="btn btn-add-c" onclick="addCell('comment')">+ å¢åŠ æ„Ÿæƒ³å—</button>
        </div>

        <button class="btn btn-gen" onclick="generateJSON()">âœ¨ ç”Ÿæˆ JSON ä»£ç </button>
        <pre id="output-area"></pre>
    </div>
</main>

<script>
    // --- 1. è½®æ’­é€»è¾‘å®ç° (1-12å¼ å›¾) ---
    const imageData = [
        { src: '1.jpg', scale: 1.0 }, { src: '2.jpg', scale: 1.05 }, { src: '3.jpg', scale: 1.1 },
        { src: '4.jpg', scale: 1.0 }, { src: '5.jpg', scale: 1.05 }, { src: '6.jpg', scale: 1.1 },
        { src: '7.jpg', scale: 1.0 }, { src: '8.jpg', scale: 1.05 }, { src: '9.jpg', scale: 1.1 },
        { src: '10.png', scale: 1.0 }, { src: '11.jpg', scale: 1.05 }, { src: '12.jpg', scale: 1.1 }
    ];

    let currentIndex = 0;
    const slide1 = document.getElementById('slide1');
    const slide2 = document.getElementById('slide2');
    let activeSlide = slide1;

    function changeSlide() {
        currentIndex = (currentIndex + 1) % imageData.length;
        const nextData = imageData[currentIndex];
        const nextSlide = (activeSlide === slide1) ? slide2 : slide1;

        nextSlide.style.backgroundImage = `url('${nextData.src}')`;
        nextSlide.style.transform = `scale(${nextData.scale})`;
        nextSlide.classList.add('active');
        activeSlide.classList.remove('active');
        activeSlide = nextSlide;
    }

    // åˆå§‹åŒ–ç¬¬ä¸€å¼ å›¾
    slide1.style.backgroundImage = `url('${imageData[0].src}')`;
    slide1.style.transform = `scale(${imageData[0].scale})`;
    setInterval(changeSlide, 4500);

    // --- 2. åŸºç¡€åˆå§‹åŒ– ---
    document.getElementById('time').valueAsDate = new Date();

    function addCell(type) {
        const container = document.getElementById('cells-container');
        const div = document.createElement('div');
        div.className = `content-cell cell-${type}`;
        div.setAttribute('data-type', type);
        const label = type === 'material' ? 'æ‘˜æŠ„å—' : 'æ„Ÿæƒ³å—';
        div.innerHTML = `
            <span class="cell-type-tag">${label}</span>
            <textarea class="cell-textarea" placeholder="è¾“å…¥${label}å†…å®¹..."></textarea>
            <button class="btn btn-del" onclick="this.parentElement.remove()">åˆ é™¤</button>
        `;
        container.appendChild(div);
        div.querySelector('textarea').focus();
    }

    function generateJSON() {
        const cells = document.querySelectorAll('.content-cell');
        let contents = [];
        let currentGroup = null;

        cells.forEach(cell => {
            const type = cell.getAttribute('data-type');
            const val = cell.querySelector('textarea').value;
            if (type === 'material') {
                currentGroup = { "material": val, "comments": [] };
                contents.push(currentGroup);
            } else if (type === 'comment') {
                if (!currentGroup) {
                    currentGroup = { "material": "", "comments": [] };
                    contents.push(currentGroup);
                }
                currentGroup.comments.push(val);
            }
        });

        const result = {
            "KEY": {
                "title": document.getElementById('title').value,
                "author": document.getElementById('author').value,
                "time": document.getElementById('time').value,
                "source": document.getElementById('source').value,
                "type": document.getElementById('type').value,
                "detail": document.getElementById('detail').value,
                "tag": document.getElementById('tag').value.split(',').map(s => s.trim()).filter(s => s),
                "link": document.getElementById('link').value.split(',').map(s => s.trim()).filter(s => s),
                "contents": contents
            }
        };

        const str = JSON.stringify(result, null, 4);
        const output = document.getElementById('output-area');
        output.textContent = str.substring(1, str.length - 1).trim() + ",";
        output.style.display = 'block';
        output.scrollIntoView({ behavior: 'smooth' });
    }

    // --- 3. éŸ³ä¹æ’­æ”¾é€»è¾‘ ---
    const MUSIC_FILES = ['jazz.mp3', 'Over_Reprise.mp3', 'jazz2.mp3', 'jazz3.mp3'];
    let currentTrackIndex = 0;
    const audio = new Audio();
    audio.volume = 0.3;
    const musicToggleBtn = document.getElementById('music-toggle');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    function loadTrack(index) {
        currentTrackIndex = (index + MUSIC_FILES.length) % MUSIC_FILES.length;
        audio.src = MUSIC_FILES[currentTrackIndex];
        audio.load();
    }
    function updateBtn() { musicToggleBtn.textContent = audio.paused ? 'â–¶' : 'â¸'; }
    musicToggleBtn.addEventListener('click', () => {
        if (audio.paused) { if (!audio.src) loadTrack(0); audio.play().then(updateBtn); }
        else { audio.pause(); updateBtn(); }
    });
    prevBtn.addEventListener('click', () => { loadTrack(currentTrackIndex - 1); audio.play().then(updateBtn); });
    nextBtn.addEventListener('click', () => { loadTrack(currentTrackIndex + 1); audio.play().then(updateBtn); });
    audio.addEventListener('ended', () => { loadTrack(currentTrackIndex + 1); audio.play().then(updateBtn); });
</script>

</body>
</html>
